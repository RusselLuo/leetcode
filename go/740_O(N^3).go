package main

import (
	"fmt"
	"sort"
)

func reduce(nums []int) ([]int, []int) {
	sort.Ints(nums)
	elems, counts := make([]int, 0), make([]int, 0)
	last := 0
	count := -1
	for _, i := range nums {
		if i != last {
			elems = append(elems, i)
			counts = append(counts, 0)
			count++
			last = i
		}
		counts[count]++
	}
	return elems, counts
}

func deleteAndEarn(nums []int) int {
	if len(nums) == 0 {
		return 0
	}
	elems, counts := reduce(nums)
	mem := make([][]int, len(elems))
	for i := 0; i < len(elems); i++ {
		mem[i] = make([]int, len(elems))
	}
	for i := 0; i < len(elems); i++ {
		mem[i][i] = elems[i] * counts[i]
	}
	for dis := 1; dis < len(elems); dis++ {
		for h := 0; h < len(elems)-dis; h++ {
			maxVal := -1
			left, right := h, h+dis
			for i := left; i <= right; i++ {
				var temp, leftSum, rightSum int
				if i-1 < left || (i-2 < left && elems[i-1] == elems[i]-1) {
					leftSum = 0
				} else if elems[i-1] == elems[i]-1 {
					leftSum = mem[left][i-2]
				} else {
					leftSum = mem[left][i-1]
				} //get left sum
				if i+1 > right || (i+2 > right && elems[i+1] == elems[i]+1) {
					rightSum = 0
				} else if elems[i+1] == elems[i]+1 {
					rightSum = mem[i+2][right]
				} else {
					rightSum = mem[i+1][right]
				} //get right sum
				temp = elems[i]*counts[i] + rightSum + leftSum
				// fmt.Println(temp)
				if temp > maxVal {
					maxVal = temp
				}
			}
			mem[h][h+dis] = maxVal
		}
	}
	return mem[0][len(elems)-1]
}

func main() {
	fmt.Println(deleteAndEarn([]int{840, 730, 432, 889, 10, 170, 150, 593, 398, 664, 85, 513, 71, 896, 444, 538, 922, 462, 993, 523, 58, 614, 529, 38, 83, 673, 459, 890, 481, 280, 273, 371, 396, 342, 802, 267, 730, 231, 402, 50, 603, 337, 551, 401, 530, 362, 779, 336, 185, 105, 771, 802, 208, 524, 853, 241, 534, 48, 576, 298, 463, 38, 621, 737, 20, 748, 461, 737, 61, 545, 365, 405, 280, 816, 271, 944, 972, 572, 886, 352, 162, 811, 931, 394, 944, 467, 326, 100, 531, 985, 342, 686, 901, 503, 177, 411, 586, 500, 789, 695, 710, 938, 96, 169, 782, 229, 666, 945, 662, 728, 320, 570, 301, 260, 471, 437, 599, 111, 910, 773, 611, 664, 220, 994, 296, 42, 934, 394, 502, 258, 198, 41, 719, 611, 699, 398, 427, 821, 894, 59, 779, 30, 891, 412, 193, 407, 395, 755, 467, 126, 542, 851, 515, 192, 374, 894, 130, 885, 212, 419, 220, 6, 248, 837, 573, 165, 392, 103, 67, 913, 247, 381, 607, 412, 354, 372, 463, 321, 480, 890, 880, 513, 499, 31, 729, 315, 221, 664, 546, 568, 126, 530, 571, 387, 458, 143, 193, 163, 97, 259, 90, 999, 561, 386, 140, 687, 217, 274, 417, 426, 560, 969, 249, 216, 850, 592, 17, 550, 965, 621, 929, 265, 788, 189, 590, 291, 916, 336, 63, 988, 484, 486, 676, 603, 359, 343, 845, 292, 525, 509, 460, 559, 836, 819, 690, 321, 742, 557, 409, 117, 895, 167, 674, 412, 303, 54, 217, 181, 302, 135, 733, 884, 656, 300, 221, 292, 677, 311, 315, 307, 785, 79, 297, 995, 832, 125, 471, 131, 9, 683, 350, 414, 82, 532, 902, 758, 953, 808, 185, 515, 570, 196, 778, 198, 208, 350, 205, 682, 687, 433, 796, 83, 636, 935, 767, 882, 481, 554, 664, 650, 664, 87, 607, 908, 221, 801, 724, 764, 928, 365, 505, 510, 714, 396, 395, 873, 520, 508, 101, 742, 17, 136, 18, 994, 622, 199, 896, 124, 626, 229, 638, 725, 617, 618, 353, 242, 348, 922, 812, 279, 584, 929, 566, 2, 449, 700, 414, 879, 401, 165, 970, 487, 984, 484, 352, 309, 48, 494, 655, 518, 880, 12, 225, 737, 746, 347, 984, 628, 548, 709, 706, 752, 53, 237, 391, 327, 591, 565, 716, 113, 544, 740, 732, 463, 523, 113, 200, 589, 189, 639, 297, 722, 408, 587, 205, 448, 581, 672, 436, 530, 801, 12, 422, 888, 521, 596, 7, 75, 669, 228, 8, 794, 637, 993, 856, 788, 682, 420, 318, 767, 285, 82, 584, 556, 236, 851, 35, 504, 647, 256, 575, 932, 13, 4, 912, 267, 241, 521, 39, 28, 56, 729, 139, 284, 922, 76, 897, 12, 949, 603, 930, 955, 649, 401, 732, 848, 68, 650, 148, 765, 455, 801, 483, 963, 83, 386, 736, 673, 834, 665, 774, 701, 295, 769, 29, 597, 786, 35, 550, 329, 649, 387, 118, 573, 365, 522, 817, 379, 177, 209, 524, 80, 933, 760, 648, 549, 50, 833, 126, 960, 375, 451, 730, 515, 14, 434, 985, 818, 411, 508, 31, 893, 817, 305, 695, 922, 477, 611, 361, 943, 663, 263, 805, 366, 204, 976, 358, 727, 593, 992, 367, 106, 92, 938, 861, 633, 929, 741, 11, 34, 555, 769, 252, 4, 627, 220, 749, 615, 469, 616, 443, 468, 230, 285, 650, 750, 561, 820, 117, 967, 343, 698, 328, 383, 558, 657, 104, 976, 326, 954, 689, 776, 888, 413, 921, 311, 176, 309, 365, 874, 530, 533, 928, 587, 739, 313, 122, 683, 911, 675, 900, 96, 435, 375, 333, 354, 710, 191, 883, 448, 115, 492, 567, 259, 763, 189, 945, 899, 27, 807, 980, 477, 331, 67, 366, 925, 596, 965, 894, 182, 673, 337, 884, 165, 549, 599, 196, 193, 603, 849, 46, 363, 776, 355, 349, 865, 245, 536, 409, 188, 400, 953, 446, 947, 24, 610, 832, 925, 92, 759, 425, 580, 573, 265, 31, 360, 640, 585, 499, 298, 75, 650, 431, 498, 897, 830, 734, 483, 944, 757, 843, 181, 634, 573, 993, 117, 877, 546, 705, 336, 20, 824, 957, 633, 970, 384, 282, 610, 623, 102, 600, 908, 723, 56, 979, 20, 222, 562, 880, 20, 624, 296, 179, 241, 548, 602, 54, 826, 69, 629, 289, 157, 178, 971, 377, 507, 716, 695, 676, 457, 846, 634, 293, 615, 608, 63, 312, 698, 395, 383, 16, 656, 538, 564, 122, 859, 966, 668, 582, 228, 483, 140, 897, 66, 98, 580, 845, 104, 916, 439, 391, 286, 763, 215, 166, 421, 805, 403, 318, 888, 573, 687, 498, 376, 776, 582, 982, 76, 702, 399, 920, 355, 275, 476, 965, 994, 420, 737, 81, 35, 944, 99, 275, 353, 236, 726, 889, 625, 947, 179, 666, 108, 87, 642, 489, 635, 703, 653, 883, 682, 740, 62, 871, 506, 809, 813, 68, 270, 876, 835, 371, 509, 900, 946, 708, 830, 304, 808, 518, 910, 956, 941, 688, 466, 288, 379, 453, 663, 803, 368, 433, 366, 617, 74, 203, 300, 265, 34, 596, 990, 366, 933, 515, 285, 800, 717, 412, 185, 200, 207, 473, 512, 666, 600, 682, 84, 910, 76, 608, 594, 750, 618, 854, 874, 915, 230, 732, 209, 170, 354, 710, 393, 751, 453, 272, 863, 303, 380, 429, 350, 602, 457, 428, 612, 427, 610, 116, 616, 195, 712, 867, 258, 372, 331, 774, 829, 908, 1, 601, 582, 633, 706, 535, 894, 218, 199, 988, 909, 390, 143, 342, 351, 862, 963, 111, 483, 222, 416, 657, 886, 316, 282, 636, 871, 680, 733, 759, 415, 102, 585, 330, 307, 818, 236, 841, 678, 711, 364, 928, 864, 770, 816, 794, 790, 97, 385, 965, 329, 938, 988, 978, 477, 473, 616, 57, 472, 272, 841, 1, 456, 488, 679, 42, 777, 480, 342, 74, 196, 695, 868, 662, 456, 826, 837, 882, 981, 349, 703, 810, 589, 518, 761, 201, 58, 54, 539, 125, 953, 491, 82, 156, 548, 922, 757, 667, 681, 836, 376, 248, 680, 915, 936, 794, 436, 950, 180, 647, 744, 587, 959, 452, 913, 70, 349, 698, 167, 117, 886, 930, 362, 162, 434, 257, 885, 56, 872, 165, 888, 974, 911, 377, 522, 185, 466, 621, 961, 344, 973, 638, 196, 407, 452, 980, 755, 192, 756, 36, 871, 156, 831, 729, 568, 675, 19, 41, 891, 682, 300, 476, 944, 571, 466, 263, 714, 172, 538, 492, 535, 34, 447, 704, 20, 36, 699, 217, 89, 317, 860, 922, 17, 102, 354, 711, 658, 565, 279, 276, 825, 532, 285, 372, 307, 965, 930, 17, 810, 272, 845, 45, 318, 787, 586, 840, 268, 218, 418, 376, 890, 550, 855, 20, 47, 520, 165, 695, 925, 419, 690, 821, 843, 235, 98, 774, 73, 702, 61, 27, 458, 778, 558, 332, 971, 691, 716, 646, 693, 256, 570, 809, 956, 452, 829, 436, 353, 24, 246, 650, 166, 923, 305, 875, 173, 616, 112, 266, 45, 864, 203, 4, 504, 880, 496, 711, 187, 442, 554, 291, 249, 936, 621, 785, 593, 855, 684, 958, 193, 719, 235, 1, 592, 983, 357, 241, 839, 520, 538, 554, 467, 678, 467, 977, 266, 35, 952, 177, 813, 307, 994, 95, 3, 623, 836, 555, 707, 990, 363, 363, 978, 574, 611, 857, 296, 148, 98, 316, 188, 794, 848, 947, 725, 400, 312, 313, 655, 590, 760, 55, 712, 642, 809, 377, 123, 933, 386, 875, 150, 13, 324, 42, 162, 255, 3, 22, 856, 531, 92, 394, 995, 215, 499, 896, 758, 288, 451, 41, 324, 341, 588, 258, 34, 71, 586, 452, 367, 981, 719, 528, 559, 862, 209, 31, 667, 170, 630, 43, 503, 907, 680, 454, 523, 154, 493, 104, 639, 50, 16, 489, 787, 964, 506, 77, 39, 574, 869, 982, 656, 533, 165, 366, 823, 546, 556, 903, 355, 871, 72, 42, 302, 206, 476, 915, 370, 783, 993, 942, 375, 585, 985, 524, 865, 329, 975, 772, 454, 178, 546, 753, 400, 464, 83, 813, 914, 133, 706, 676, 434, 792, 962, 849, 131, 489, 752, 907, 256, 301, 577, 476, 223, 964, 946, 461, 382, 374, 395, 803, 757, 919, 991, 252, 177, 546, 51, 765, 963, 801, 384, 113, 50, 565, 746, 129, 654, 605, 574, 225, 853, 902, 185, 467, 105, 813, 26, 741, 940, 642, 843, 60, 2, 986, 928, 968, 31, 124, 303, 885, 756, 847, 552, 524, 1, 787, 51, 365, 98, 157, 458, 137, 448, 612, 559, 663, 579, 814, 79, 540, 69, 834, 218, 709, 846, 33, 592, 151, 181, 572, 14, 416, 655, 56, 235, 65, 379, 949, 61, 707, 89, 418, 876, 527, 527, 506, 101, 518, 464, 319, 198, 546, 115, 4, 706, 971, 302, 690, 255, 903, 907, 348, 561, 687, 638, 450, 473, 826, 113, 787, 525, 971, 878, 636, 50, 324, 814, 211, 702, 442, 282, 371, 933, 584, 317, 873, 801, 79, 703, 988, 609, 691, 186, 739, 721, 346, 791, 750, 763, 104, 514, 823, 78, 673, 976, 834, 791, 936, 39, 929, 170, 11, 58, 445, 95, 402, 745, 65, 404, 59, 810, 558, 728, 840, 350, 313, 763, 253, 880, 75, 792, 595, 973, 433, 333, 800, 147, 735, 759, 50, 117, 328, 445, 710, 860, 775, 457, 445, 729, 759, 896, 114, 452, 500, 138, 14, 56, 680, 109, 672, 849, 142, 939, 644, 670, 160, 554, 155, 900, 782, 475, 769, 167, 629, 692, 386, 993, 241, 482, 928, 12, 787, 592, 212, 129, 651, 280, 266, 16, 810, 188, 776, 151, 916, 772, 198, 347, 553, 747, 319, 165, 922, 395, 706, 360, 476, 893, 429, 338, 475, 84, 683, 144, 88, 561, 952, 975, 785, 583, 80, 125, 22, 896, 198, 992, 302, 61, 251, 938, 59, 472, 492, 325, 655, 337, 747, 668, 693, 793, 575, 550, 89, 472, 85, 616, 194, 48, 544, 191, 71, 285, 280, 215, 456, 274, 43, 135, 823, 457, 943, 27, 30, 680, 799, 424, 382, 359, 149, 146, 438, 225, 855, 782, 220, 368, 323, 331, 955, 717, 383, 991, 153, 87, 857, 487, 989, 161, 472, 260, 210, 580, 590, 147, 984, 57, 416, 189, 154, 787, 289, 325, 7, 560, 734, 245, 932, 838, 11, 313, 904, 393, 737, 421, 281, 480, 47, 960, 548, 164, 930, 560, 978, 363, 296, 860, 841, 947, 891, 460, 868, 170, 761, 765, 861, 876, 850, 934, 128, 312, 438, 914, 159, 463, 592, 177, 536, 64, 472, 251, 708, 672, 199, 272, 264, 298, 44, 32, 194, 639, 108, 812, 827, 882, 720, 326, 457, 761, 158, 891, 657, 672, 43, 872, 889, 772, 548, 743, 730, 27, 760, 778, 864, 857, 636, 544, 857, 96, 150, 248, 966, 985, 506, 291, 169, 373, 187, 595, 340, 662, 707, 69, 620, 339, 619, 288, 343, 803, 596, 885, 423, 239, 489, 431, 603, 143, 224, 439, 386, 315, 670, 310, 473, 86, 576, 24, 718, 285, 291, 991, 319, 375, 808, 432, 472, 120, 316, 27, 604, 672, 777, 215, 189, 940, 604, 324, 39, 423, 937, 147, 836, 825, 275, 821, 453, 425, 111, 260, 848, 705, 942, 678, 534, 995, 365, 1, 243, 193, 63, 314, 524, 9, 760, 451, 345, 775, 882, 501, 148, 595, 272, 325, 726, 400, 248, 532, 742, 424, 512, 519, 795, 161, 860, 171, 325, 953, 730, 102, 757, 698, 491, 800, 332, 727, 239, 907, 697, 185, 744, 127, 613, 73, 48, 515, 960, 159, 266, 718, 923, 576, 773, 550, 776, 315, 356, 686, 382, 845, 726, 248, 868, 542, 697, 156, 54, 172, 471, 867, 138, 571, 505, 783, 101, 86, 608, 574, 809, 835, 67, 155, 108, 221, 7, 633, 52, 200, 420, 299, 861, 557, 318, 744, 651, 544, 169, 145, 952, 518, 479, 173, 612, 281, 351, 994, 374, 820, 313, 942, 539, 703, 992, 237, 836, 323, 260, 196, 714, 794, 118, 748, 882, 280, 363, 442, 658, 213}))
}
